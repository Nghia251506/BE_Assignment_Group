
spring:
  application:
    name: news-crawler

  datasource:
    url: jdbc:mysql://${DB_HOST}:${DB_PORT}/${DB_NAME:news_crawler}?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Bangkok&useUnicode=true&characterEncoding=UTF-8
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    database-platform: org.hibernate.dialect.MySQL8Dialect
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        format_sql: true
    open-in-view: false

  # ==================== REDIS CONFIG (ĐÃ THÊM) ====================
  data:
    redis:
      url: ${REDIS_URL:redis-16809.c252.ap-southeast-1-1.ec2.cloud.redislabs.com:16809}  # Railway sẽ inject REDIS_URL, local fallback
      # BỎ HẾT host/port/password/username/database ở đây – để Jedis Bean xử lý
      jedis: # Chuyển sang Jedis client
        pool:
          enabled: true
          max-active: 8      # Giữ thấp cho free tier (tránh socket drop)
          max-idle: 4
          min-idle: 0
          max-wait: 5000ms
          time-between-eviction-runs: 30000ms  # Cleanup idle connections

server:
  port: ${PORT:8080}

# Crawler schedule
crawler:
  cron: "*/30 * * * * *"

# Swagger UI
springdoc:
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
  api-docs:
    enabled: true

# RabbitMQ
  rabbitmq:
    host: ${RABBITMQ_HOST:localhost}
    port: ${RABBITMQ_PORT:5672}
    username: ${RABBITMQ_USERNAME:guest}
    password: ${RABBITMQ_PASSWORD:guest}

rabbit:
  exchange: news.exchange
  routing:
    links: news.links

# JWT
jwt:
  secret-key: ${JWT_SECRET_KEY:c0480841-a0ed-42f3-a72b-a3d38b58406e}

# CORS
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics

# GA4 CONFIG
google:
  project-id: ${GA4_PROJECT_ID}
  client-email: ${GA4_CLIENT_EMAIL}
  private-key: ${GA4_PRIVATE_KEY}
  property-id: ${GA4_PROPERTY_ID}
  credentials-base64: ${GA4_CREDENTIALS_BASE64:}
